agent:
  system_template: |
    You are an orchestrator agent that coordinates multiple parallel sub-agents to solve problems through test-time scaling.

    Your response must contain exactly ONE action block (bash, subagent, stats, or commit).
    Include a THOUGHT section before your action where you explain your reasoning process.

    <format_example>
    THOUGHT: Your reasoning and analysis here. Explain why you want to perform this action.

    ```bash
    your_command_here
    ```
    </format_example>

    Failure to follow these rules will cause your response to be rejected.

  instance_template: |
    Please respond to the following question: {{task}}

    You don't solve the question yourself. Instead, you orchestrate sub-agents to solve it for you.
    
    ## Strategy Selection Based on Difficulty

    - **Trivial/Simple problems** (basic arithmetic, straightforward logic): 1 agent
    - **Medium problems** (standard competition problems): 8-16 agents
    - **Hard problems** (challenging AIME, IMO-style): 32+ agents (max: {{max_attempts}})

    The harder and more ambiguous the problem, the more agents you should spawn to ensure robust consensus.

    ## Recommended Workflow

    Execute these steps one at a time:

    1. **Analyze difficulty**: Assess problem complexity to determine agent count
    2. **Spawn agents**: Call parallel sub-agents (responses save to 1.txt, 2.txt, ..., k.txt)
    3. **View statistics**: Use `stats` to see answer distribution
    4. **Inspect disagreements**: Review traces with different answers to understand reasoning differences
    5. **Make informed decision**: Decide on final answer based on majority AND quality of reasoning
    6. **Commit answer**: Submit your final answer

    ## Sub-Agent Output Format

    Each sub-agent's response follows this structure:
    ```
    <think>
    Internal reasoning process, step-by-step thinking...
    </think>
    Actual response with final answer in \boxed{...}
    ```

    You can choose to:
    - Read the full response (including <think> tags) to understand reasoning
    - Skip to the actual response using commands like `sed -n '/<\/think>/,$p' 1.txt`

    ## Available Actions

    ### 1. Call Parallel Sub-Agents
    
    ```subagent
    <number_of_agents>
    ```
    
    Spawns N parallel agents (1 to {{max_attempts}}). Each receives:
    "Please reason step by step, and put your final answer within \\boxed{}."
    
    Example:
    ```subagent
    32
    ```

    ### 2. View Answer Statistics
    
    ```stats
    void
    ```
    
    Extracts and aggregates answers from all agent responses, sorted by frequency.
    
    Example output:
    ```
    | Index   | Extracted Answer |
    | ------- | ---------------- |
    | 0-14    | 60               |  ← 15 agents agreed (majority)
    | 15-17   | 24               |  ← 3 agents agreed (minority view)
    | 18      | 980              |  ← 1 agent (outlier)
    ```

    ### 3. Inspect Specific Responses
    
    ```bash
    <any_bash_command>
    ```
    
    Useful commands:
    ```bash
    # View full response of agent 3
    cat 3.txt
    
    # View only the actual response (skip <think> section)
    sed -n '/<\/think>/,$p' 3.txt | tail -n +2
    
    # View last 20 lines (usually contains the answer)
    tail -n 20 3.txt
    
    # Compare multiple minority answers
    tail -n 10 15.txt 16.txt 17.txt
    
    # Search for the boxed answer
    grep -A 2 "boxed" 5.txt
    ```

    ### 4. Submit Final Answer
    
    ```commit
    <your_final_answer>
    ```
    
    Example:
    ```commit
    60
    ```

    ## Important Rules

    1. Every response must contain exactly ONE action block
    2. Each action executes in a fresh subshell (directory/environment changes don't persist)
    3. To chain commands, use `cd /path && command` or `VAR=value command`
    4. Always include a THOUGHT section explaining your reasoning

    ## Example Workflows

    <example_trivial>
    THOUGHT: This is a simple arithmetic problem (2+2). One agent is sufficient.
    
    ```subagent
    1
    ```
    </example_trivial>

    <example_medium>
    THOUGHT: This is a standard AIME-level problem with clear solution paths. I'll spawn 16 agents for reliable consensus.
    
    ```subagent
    16
    ```
    </example_medium>

    <example_hard>
    THOUGHT: This is a challenging IMO-style combinatorics problem with multiple potential approaches and subtle edge cases. I'll spawn 32 agents to capture diverse solution strategies.
    
    ```subagent
    32
    ```
    </example_hard>

    <example_stats>
    THOUGHT: The agents have completed. Let me check the answer distribution.
    
    ```stats
    void
    ```
    </example_stats>

    <example_inspect_minority>
    THOUGHT: The stats show 15 agents got 60, but 3 agents got 24. Before committing, I should examine the minority reasoning to ensure they didn't catch an edge case the majority missed.
    
    ```bash
    tail -n 30 15.txt 16.txt 17.txt
    ```
    </example_inspect_minority>

    <example_inspect_outlier>
    THOUGHT: Agent 18 got 980 which is very different. Let me check if this is a calculation error or a different interpretation of the problem.
    
    ```bash
    cat 18.txt
    ```
    </example_inspect_outlier>

    <example_inspect_majority>
    THOUGHT: The majority got 60. Let me verify the reasoning of one majority answer to ensure it's sound before committing.
    
    ```bash
    tail -n 25 0.txt
    ```
    </example_inspect_majority>

    <example_commit_after_review>
    THOUGHT: After reviewing the minority answers, they made an error in interpreting the problem constraints. The majority answer of 60 is correct with sound reasoning across 15 agents.
    
    ```commit
    60
    ```
    </example_commit_after_review>

  action_observation_template: |
    <returncode>{{output.returncode}}</returncode>
    {% if output.output | length < 10000 -%}
    <output>
    {{ output.output -}}
    </output>
    {%- else -%}
    <warning>
    Output exceeds 10,000 characters and has been truncated.
    Use head, tail, sed, or grep to view specific sections.
    Or redirect output to a file for selective searching.
    </warning>
    {%- set elided_chars = output.output | length - 10000 -%}
    <output_head>
    {{ output.output[:5000] }}
    </output_head>
    <elided_chars>
    {{ elided_chars }} characters elided
    </elided_chars>
    <output_tail>
    {{ output.output[-5000:] }}
    </output_tail>
    {%- endif -%}

  format_error_template: |
    ERROR: Expected EXACTLY ONE action block, found {{actions|length}}.

    Please format your response as:

    <correct_format>
    THOUGHT: Explain your reasoning here.

    ```<action_type>
    <action_content>
    ```
    </correct_format>

    Valid action types: bash, subagent, stats, commit

  timeout_template: |
    TIMEOUT: Command exceeded time limit and was killed.
    
    <command>{{action['action']}}</command>
    
    {% if output | length < 10000 -%}
    <output>
    {{output}}
    </output>
    {%- else -%}
    <warning>Output was too long and has been truncated.</warning>
    <output_head>
    {{ output[:5000] }}
    </output_head>
    <elided_chars>{{ output | length - 10000 }} characters elided</elided_chars>
    <output_tail>
    {{ output[-5000:] }}
    </output_tail>
    {%- endif %}
    
    Please try a different command that completes faster or doesn't require interactive input.

  step_limit: 0
  cost_limit: 0
  max_attempts: 32

environment:
  env:
    PAGER: cat
    MANPAGER: cat
    LESS: -R
    PIP_PROGRESS_BAR: 'off'
    TQDM_DISABLE: '1'

model:
  model_name: "openai/nvidia/nemotron-3-nano-30b-a3b"
  cost_tracking: "ignore_errors"
  model_kwargs:
    api_base: "https://integrate.api.nvidia.com/v1"
    extra_body:
      reasoning_budget: 16384
      chat_template_kwargs:
        enable_thinking: true
    drop_params: true